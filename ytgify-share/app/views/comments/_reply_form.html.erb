<%= turbo_frame_tag "reply_form_#{parent_comment.id}" do %>
  <%= form_with model: [gif, gif.comments.build(parent_comment_id: parent_comment.id)],
                url: gif_comments_path(gif),
                class: "mt-4 flex space-x-3" do |f| %>
    <%= f.hidden_field :parent_comment_id %>

    <div class="w-10 h-10 bg-indigo-600 text-white rounded-full flex items-center justify-center font-semibold flex-shrink-0">
      <%= current_user.username.first.upcase %>
    </div>

    <div class="flex-1">
      <%= f.text_area :content,
          placeholder: "Write a reply...",
          rows: 2,
          autofocus: true,
          class: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent resize-none #{'border-red-500' if local_assigns[:comment]&.errors&.any?}" %>

      <% if local_assigns[:comment]&.errors&.any? %>
        <div class="mt-2 text-sm text-red-600">
          <%= comment.errors.full_messages.to_sentence %>
        </div>
      <% end %>

      <div class="mt-2 flex justify-end space-x-2">
        <%= link_to "Cancel",
            "#",
            onclick: "this.closest('turbo-frame').innerHTML = ''; return false;",
            class: "px-4 py-2 text-sm text-gray-700 bg-white border border-gray-300 rounded hover:bg-gray-50" %>
        <%= f.submit "Reply",
            class: "px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 font-medium cursor-pointer transition-colors",
            data: { turbo_submits_with: "Replying..." } %>
      </div>
    </div>
  <% end %>
<% end %>
